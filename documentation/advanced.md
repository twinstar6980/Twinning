# é«˜çº§åº”ç”¨

- [ç†è§£è¿è¡Œæµç¨‹](#ç†è§£è¿è¡Œæµç¨‹)

- [ç¬¬ä¸‰æ–¹é›†æˆ](#ç¬¬ä¸‰æ–¹é›†æˆ)

- [è‡ªå®šä¹‰è„šæœ¬](#è‡ªå®šä¹‰è„šæœ¬)
	
	- [ä¸»è„šæœ¬](#ä¸»è„šæœ¬)
	
	- [å†…æ ¸æ¥å£](#å†…æ ¸æ¥å£)
	
	- [å†…å­˜æ“ä½œ](#å†…å­˜æ“ä½œ)
	
	- [æ–‡ä»¶ç³»ç»Ÿ](#æ–‡ä»¶ç³»ç»Ÿ)
	
	- [JSON è¯»å†™](#JSON-è¯»å†™)
	
	- [ç‰¹æ®Šæ–‡ä»¶ç¼–ç è§£ç ](#ç‰¹æ®Šæ–‡ä»¶ç¼–ç è§£ç )
	
	- [å†…æ ¸æ¥å£å°è£…](#å†…æ ¸æ¥å£å°è£…)

## ç†è§£è¿è¡Œæµç¨‹

å·¥å…·é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåˆ†ä¸ºä¸‰ä¸ªå±‚çº§ï¼š

* `Kernel` å±‚ï¼šåç«¯ï¼Œè´Ÿè´£æ•°æ®å¤„ç†ï¼Œä¸ä¼šè¿›è¡Œä»»ä½•ç”¨æˆ·äº¤äº’ï¼›`Kernel` è¢«åˆ†å‘ä¸ºé¢å‘å„å¹³å°çš„æœ¬æœºåŠ¨æ€åº“ã€‚
	
	> `Kernel` æ¨¡å—å®ç°äº†è¿™ä¸€å±‚çº§ã€‚

* `Shell` å±‚ï¼šå‰ç«¯ï¼Œè´Ÿè´£ç”¨æˆ·äº¤äº’ï¼Œä¸ä¼šè¿›è¡Œä»»ä½•æ•°æ®å¤„ç†ï¼›`Shell` è¢«åˆ†å‘ä¸ºé¢å‘å„å¹³å°çš„æœ¬æœºåº”ç”¨ç¨‹åºï¼Œä¼šåŠ è½½å†…æ ¸åŠ¨æ€åº“ï¼Œå¹¶ä»¥ç”¨æˆ·æä¾›çš„è„šæœ¬ä½œä¸ºå‚æ•°è°ƒç”¨å†…æ ¸åŠ¨æ€åº“çš„æ¥å£å‡½æ•°ã€‚
	
	> `Shell` ã€`Assistant` ã€`Assistant Plus` æ¨¡å—å®ç°äº†è¿™ä¸€å±‚çº§ã€‚

* `Script` å±‚ï¼šå‰åç«¯çš„æ¡¥æ¢ï¼Œé€šè¿‡è°ƒç”¨å†…æ ¸ä¸å¤–å£³æä¾›çš„æ¥å£å‡½æ•°è¿›è¡Œæ•°æ®å¤„ç†ä¸ç”¨æˆ·äº¤äº’ï¼›`Script` è¢«åˆ†å‘ä¸ºä¸ä¾èµ–å¹³å°çš„ JavaScript è„šæœ¬ã€‚
	
	> `Script` æ¨¡å—å®ç°äº†è¿™ä¸€å±‚çº§ã€‚

é€šè¿‡å‰åç«¯åˆ†ç¦»çš„æ–¹å¼ï¼Œå·¥å…·èƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œè·¨å¹³å°é€‚é…ä¸å¤šå®¢æˆ·ç«¯é›†æˆã€‚

å·¥å…·çš„è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š

1. ç”¨æˆ·å¯åŠ¨ `Shell` ï¼Œå¹¶ä¼ é€’å·¥å…·è¿è¡Œæ‰€éœ€å‚æ•°ã€‚

2. `Shell` å¯åŠ¨åï¼Œä»ç”¨æˆ·æä¾›çš„å‚æ•°ä¸­è·å– `Kernel` çš„æ–‡ä»¶è·¯å¾„ã€å·¥å…·éœ€è¦æ‰§è¡Œçš„ `Script` ï¼Œä»¥åŠä¼ é€’ç»™ `Script` çš„å‚æ•°ã€‚

3. `Shell` åŠ è½½ `Kernel` ï¼Œè°ƒç”¨å…¶æ¥å£å‡½æ•°ï¼Œå¹¶å°† `Script` åŠå‚æ•°ä¼ é€’ç»™å®ƒã€‚

4. `Kernel` æ‰§è¡Œ `Script` ï¼Œå¹¶å°†æ‰§è¡Œç»“æœè¿”å›è‡³ `Shell` ã€‚

5. `Shell` å¾—åˆ°è¿”å›å€¼ï¼Œè¾“å‡ºç»™ç”¨æˆ·ï¼Œç»ˆæ­¢ç¨‹åºã€‚
	
	>  `Script` å¯ä»¥è°ƒç”¨ `Shell` æä¾›ç»™ `Kernel` çš„å›è°ƒå‡½æ•°ï¼Œä»è€Œåœ¨æ‰§è¡ŒæœŸé—´ä¸ç”¨æˆ·äº¤äº’ã€‚

## ç¬¬ä¸‰æ–¹é›†æˆ

> **ä»¥ä¸‹å†…å®¹éœ€è¦ç”¨æˆ·æŒæ¡ä¸€å®šçš„ç¼–ç¨‹æŠ€èƒ½ã€‚**

ç”¨æˆ·å¯ä»¥é€šè¿‡ `C` ã€`C++` ã€`C#` ã€`Kotlin` ã€`Python` åœ¨å†…çš„å„ç±»ç¼–ç¨‹è¯­è¨€æ‰€æä¾›çš„ `Foreign Function Interface` æœºåˆ¶å°†å·¥å…·åç«¯ï¼ˆ `Kernel` ï¼‰é›†æˆè‡³è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨è‡ªå®šä¹‰é¡¹ç›®ï¼ˆå³è‡ªå®ç°çš„ `Shell` å±‚ï¼‰ä¸­åŠ è½½ `Kernel` çš„æœ¬æœºåŠ¨æ€åº“ï¼Œè·å– `Kernel` çš„æ¥å£å‡½æ•°ã€‚

2. è°ƒç”¨ `Kernel` çš„æ¥å£å‡½æ•°ï¼Œæ¥å£å‡½æ•°ä¸­çš„ `callback` å‚æ•°æ˜¯è‡ªå®šä¹‰é¡¹ç›®æ‰€éœ€è¦æä¾›çš„å¤–å£³å›è°ƒå®ç°ã€‚

å…·ä½“å‚ç…§æœ¬å·¥å…·å†…çš„å‡ ä¸ªå¤–å£³å®ç°ï¼š

* [`Shell`](../Shell/shell/bridge) with `C++`

* [`Assistant`](../Assistant/lib/bridge) with `Dart`

* [`Assistant Plus`](../AssistantPlus/Application/Bridge) with `C#`

ä¸‹é¢ä»¥ [`Shell`](../Shell/shell/bridge) æ¨¡å—ä¸ºä¾‹ä»‹ç»åº”å¦‚ä½•é›†æˆ `Kernel` ï¼š

1. [`data.cppm`](../Shell/shell/bridge/data.cppm) ï¼šå£°æ˜ `Kernel` ä¸­çš„æ•°æ®ç±»å‹ã€‚
	
	> `Kernel` æ¨¡å—ä¸­å·²ç»æä¾›äº†é€‚ç”¨äº `C++` çš„æ¥å£å£°æ˜ [`interface.hpp`](https://github.com/twinstar6980/Twinning/blob/master/Kernel/kernel/interface/interface.hpp) ï¼Œæ¥å£éœ€è¦ç”¨æˆ·ä¼ é€’ C å¼çš„ç»“æ„ä½“ä½œä¸ºå‚æ•°å€¼ä¸è¿”å›å€¼ã€‚

2. [`proxy.cppm`](../Shell/shell/bridge/proxy.cppm) ï¼šåˆ›å»ºä¸€ä¸ªè¾…åŠ©ç±»ï¼Œè´Ÿè´£æ¥å£æ‰€éœ€çš„ C å¼ç»“æ„ä½“çš„è§£æä¸æ„é€ ã€‚

3. [`service.cppm`](../Shell/shell/bridge/service.cppm) ï¼šå£°æ˜ `Kernel` å¯¼å‡ºçš„æœåŠ¡ç±»å‹ã€‚

4. [`library.cppm`](../Shell/shell/bridge/library.cppm) ï¼šå®šä¹‰ `Kernel` åº“çš„æŠ½è±¡ç±»ï¼Œå®ƒå°è£…äº†å¯¹ `Kernel` åº“çš„åŠ è½½ä¸ç¬¦å·è·å–ã€‚

5. [`client.cppm`](https://github.com/twinstar6980/Twinning/blob/master/Shell/shell/bridge/client.cppm) ï¼šå®šä¹‰ `Shell` å®¢æˆ·ç«¯çš„æŠ½è±¡ç±»ã€‚
	
	> [`main_console.cppm`](https://github.com/twinstar6980/Twinning/blob/master/Shell/shell/main_console.cppm) ï¼šå®ç°äº†å¯¹åŸºæœ¬çš„å‘½ä»¤è¡Œå¼ `Shell` å®¢æˆ·ç«¯çš„å°è£…ã€‚

6. [`launcher.cppm`](../Shell/shell/bridge/launcher.cppm) ï¼šåˆ›å»ºä¸€ä¸ªè¾…åŠ©ç±»ï¼Œé…åˆ `Library` ä¸ `Client` å®ä¾‹è°ƒç”¨ `Kernel` æ¥å£ã€‚

## è‡ªå®šä¹‰è„šæœ¬

> **ä»¥ä¸‹å†…å®¹éœ€è¦ç”¨æˆ·æŒæ¡ TypeScript ç¼–ç¨‹æŠ€èƒ½ã€‚**

å·¥å…·çš„ `Script` å±‚ä»¥ `JavaScript` ä½œä¸ºè„šæœ¬è¯­è¨€ã€‚JS å¼•æ“ä¸ºç¬¬ä¸‰æ–¹å¼€æºé¡¹ç›® `quickjs-ng` ã€‚

ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå®šä¹‰è„šæœ¬è®©å·¥å…·æ‰§è¡Œå‡ºè‡ªå·±æƒ³è¦çš„ç»“æœã€‚

ç”¨æˆ·å¯ä»¥è‡ªè¡Œé‡å†™ä¸»è„šæœ¬çš„è¿è¡Œé€»è¾‘ï¼Œä½†æ›´æ¨èåœ¨å·²æœ‰çš„ [Script æ¨¡å—](../Script) åŸºç¡€ä¸Šæ‰©å±•å¼€å‘ï¼Œå®ƒå·²ä¸ºç”¨æˆ·æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ä¸è‰¯å¥½çš„äº¤äº’æœºåˆ¶ã€‚

ä¸‹é¢ä»‹ç»å¦‚ä½•è‡ªå®šä¹‰è„šæœ¬ã€‚

### ä¸»è„šæœ¬

`Kernel` åªä¼šæ‰§è¡Œä¸€æ®µè„šæœ¬å­—ç¬¦ä¸²æˆ–è„šæœ¬æ–‡ä»¶ï¼ˆä»¥è·¯å¾„æŒ‡å®šï¼‰ï¼Œè¿™æ®µè„šæœ¬ç§°ä¸ºä¸»è„šæœ¬ã€‚å¯ä»¥åœ¨ä¸»è„šæœ¬ä¸­åŠ è½½ä¸æ‰§è¡Œå…¶ä»–çš„è„šæœ¬ã€‚

`Kernel` è¦æ±‚ä¸»è„šæœ¬è®¡ç®—å‡ºçš„å€¼ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå³è„šæœ¬å±‚çš„ âŒˆ ä¸»å‡½æ•° âŒ‹ ï¼Œå…¶æ‹¥æœ‰å¦‚ä¸‹ç±»å‹ï¼š

```ts
type JS_MainFunction = (
	data: {
		argument: Array<string>;           // è¾“å…¥ã€‚ç”¨æˆ·ä¼ é€’ç»™å·¥å…·çš„è„šæœ¬å‚æ•°ã€‚
		result: Array<string> | undefined; // è¾“å‡ºã€‚è„šæœ¬çš„æ‰§è¡Œç»“æœï¼Œå¿…é¡»åœ¨ç¨‹åºç»“æŸå‰è®¾ç½®ä¸ºé `undefined` ã€‚
		error: any | undefined;            // è¾“å‡ºã€‚è„šæœ¬è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯ï¼Œå¦‚æœä¸ä¸º `undefined` ï¼Œå·¥å…·å°†è§†ä¸ºè„šæœ¬æ‰§è¡Œé”™è¯¯å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚
	},
) => void;
```

ä¸»å‡½æ•°å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°ï¼Œä½†å…¶ä¸­å¯ä»¥è°ƒç”¨å¼‚æ­¥å‡½æ•°ï¼Œ`Kernel` ä¼šç­‰å¾…æ‰€æœ‰å¼‚æ­¥è°ƒç”¨æ‰§è¡Œå®Œæ¯•ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå¼‚æ­¥æ‰§è¡Œä¸­æŠ›å‡ºçš„é”™è¯¯æœªé€šè¿‡ `Promise.catch` å¤„ç†ï¼Œåˆ™è¿™ä¸ªé”™è¯¯å°†è¢«é™é»˜åœ°å¿½ç•¥ã€‚

### å†…æ ¸æ¥å£

å·¥å…·çš„ `Kernel` è´Ÿè´£æ‰§è¡Œç”¨æˆ·æä¾›çš„è„šæœ¬ï¼Œå…¶ä¸­å®šä¹‰çš„å†…æ ¸æ¥å£ä¸ºè„šæœ¬å±‚æä¾›äº†å¤šæ ·çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ–‡ä»¶è¯»å†™ã€æ•°æ®æ“ä½œç­‰åŸºæœ¬åŠŸèƒ½ä¸ BNK ã€PAM ç¼–è§£ç ç­‰é«˜çº§åŠŸèƒ½ã€‚

å†…æ ¸æ¥å£å…·æœ‰ä¸¥æ ¼çš„ç±»å‹é™åˆ¶ï¼Œå› æ­¤ï¼Œåœ¨å¼€å‘å±‚é¢ï¼Œåº”ä½¿ç”¨ `TypeScript` ä½œä¸ºå¼€å‘è¯­è¨€ï¼Œå¹¶ç¼–è¯‘ä¸º `JavaScript` ä¾›å·¥å…·ä½¿ç”¨ã€‚`Script` æ¨¡å—ä¸­çš„ [`kernel.d.ts`](https://github.com/twinstar6980/Twinning/blob/master/Script/kernel.d.ts) å£°æ˜äº† `Kernel` æ‰€å®šä¹‰çš„æ¥å£ã€‚

å†…æ ¸æ¥å£åˆ†ä¸ºå†…æ ¸ç±»å‹ä¸å†…æ ¸å‡½æ•°ï¼Œå†…æ ¸ç±»å‹æ˜¯å¯¹ `Kernel` ä¸­çš„ `C++` ç±»å‹çš„å°è£…ï¼Œä¾‹å¦‚æ¥å£ä¸­çš„ `Kernel.Boolean` ç±»æ˜¯å¯¹ `Kernel` ä¸­ `C++ Boolean` ç±»çš„å°è£…ã€‚ç”¨æˆ·éœ€è¦å€ŸåŠ©å†…æ ¸ç±»å‹æ‰èƒ½ä¸å†…æ ¸å‡½æ•°äº¤äº’ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå†…æ ¸ç±»å‹çš„ç±»å®šä¹‰ä¸­æä¾›ä»¥ä¸‹å‡½æ•°ä¸æ–¹æ³•ï¼š

* `static default(): T;` ï¼šé»˜è®¤æ„é€ å‡½æ•°ï¼Œæ„é€ ä¸€ä¸ªå¸¦æœ‰é»˜è®¤å€¼çš„å†…æ ¸å¯¹è±¡ã€‚

* `static copy(it: T): T;` ï¼šå¤åˆ¶æ„é€ å‡½æ•°ï¼Œé€šè¿‡æ·±å¤åˆ¶å¦ä¸€ä¸ªå†…æ ¸å¯¹è±¡æ¥æ„é€ æ–°çš„å†…æ ¸å¯¹è±¡ã€‚

* `static value(it: typeof T.Value): T;` ï¼šå€¼æ„é€ å‡½æ•°ï¼Œä» JS å€¼æ„é€ æ–°çš„å†…æ ¸å¯¹è±¡ã€‚

* `get value(): typeof T.Value;` ï¼šå€¼è®¿é—®å™¨ï¼Œè®¿é—®å†…æ ¸å¯¹è±¡æ‰€å¯¹åº”çš„ JS å€¼ã€‚

* `set value(it: typeof T.Value);` ï¼šå€¼è®¾å®šå™¨ï¼Œè®¾å®šå†…æ ¸å¯¹è±¡æ‰€å¯¹åº”çš„ JS å€¼ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š

```ts
// æ„é€ ä¸€ä¸ªå€¼ä¸º true çš„å†…æ ¸å¸ƒå°”å¯¹è±¡
let b1 = Kernel.Boolean.value(true);
// é€šè¿‡å¤åˆ¶ b1 æ„é€ å†…æ ¸å¸ƒå°”å¯¹è±¡ï¼Œb2 å€¼ä¸º true
let b2 = Kernel.Boolean.copy(b1);
// false ï¼Œb1 ä¸ b2 æ˜¯å†…å­˜ä¸­çš„ä¸åŒå¯¹è±¡ï¼Œå³ä½¿å…¶ä¸­çš„å€¼ç›¸ç­‰
b1 == b2;
// true ï¼Œé€šè¿‡å€¼è®¿é—®å™¨å¯ä»¥è·å–å†…æ ¸å¯¹è±¡ä¸­å¯¹åº”çš„ JS å€¼
b1.value === true;
// true ï¼Œæ­¤æ—¶äºŒè€…å­˜å‚¨çš„å€¼ç›¸ç­‰
b1.value === b2.value;
// é€šè¿‡å€¼è®¾å®šå™¨å°† b1 çš„å€¼è®¾ä¸º false
b1.value = !b2.value;
// true ï¼Œæ­¤æ—¶äºŒè€…å­˜å‚¨çš„å€¼ä¸ç­‰
b1.value !== b2.value;
```

```ts
// é€šè¿‡ JS å­—ç¬¦ä¸²æ„é€ å†…æ ¸å­—ç¬¦ä¸²å¯¹è±¡
let s1 = Kernel.String.value('this is a string value.');
// true
s1.value === 'this is a string value.';
```

```ts
// æµ‹è¯•Cç›˜æ ¹ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨ sample.txt æ–‡ä»¶
// è®¾å®šè·¯å¾„å¯¹è±¡
let target_path = Kernel.Path.value('C:/sample.txt');
// è°ƒç”¨å†…æ ¸å‡½æ•°ï¼Œä¼ é€’è·¯å¾„å¯¹è±¡ï¼Œå¾—åˆ° Kernel.Boolean å¯¹è±¡
let state = Kernel.Storage.exist_file(target_path);
// å–å‡º Kernel.Boolean å¯¹è±¡çš„å€¼
let state_value = state.value;
if (state_value) {
	// å¦‚æœå­˜åœ¨ C:/sample.txt æ–‡ä»¶ï¼Œåˆ™è¯¥å€¼ä¸º true
}
```

### å†…å­˜æ“ä½œ

å†…æ ¸æ¥å£æä¾›äº†å¯¹å†…å­˜çš„ç›´æ¥æ“ä½œåŠŸèƒ½ã€‚

* `Kernel.ByteArray` ï¼šå­—èŠ‚åºåˆ—å®¹å™¨ï¼ŒæŒæœ‰ä¸€æ®µå†…å­˜ç©ºé—´ï¼Œå½“è¯¥å¯¹è±¡è¢«ææ„æ—¶ï¼Œå…¶æŒæœ‰çš„å†…å­˜ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚è¿™ä¸ªç±»å‹è´Ÿè´£ç”³è¯·å¹¶æŒæœ‰å†…å­˜ã€‚

* `Kernel.ByteListView` ï¼šå­—èŠ‚åºåˆ—è§†å›¾ï¼Œä»…ä¿å­˜å†…å­˜çš„åœ°å€ä¸å°ºå¯¸ä¿¡æ¯ï¼Œä¸æŒæœ‰æ‰€æœ‰æƒã€‚è¿™ä¸ªç±»å‹ç”¨äºåœ¨ä¸è¿›è¡Œæ·±å¤åˆ¶çš„æƒ…å†µä¸‹è®¿é—®å†…å­˜ç©ºé—´ã€‚

* `Kernel.ByteStreamView` ï¼šå­—èŠ‚æµè§†å›¾ï¼Œç›¸å½“äºå­—èŠ‚åºåˆ—è§†å›¾é™„åŠ ä¸€ä¸ªä½ç½®ä¿¡æ¯ï¼Œä½ç½®ä¿¡æ¯ç”¨äºè¡¨ç¤ºç¨‹åºå¯¹å†…å­˜çš„è¯»å–æˆ–å†™å…¥çš„å½“å‰ä½ç½®ï¼Œä¸æŒæœ‰æ‰€æœ‰æƒã€‚è¿™ä¸ªç±»å‹è¢«å†…æ ¸å‡½æ•°æ‰€å¹¿æ³›ä½¿ç”¨ã€‚

* `Kernel.CharacterListView` ï¼šå­—ç¬¦åºåˆ—è§†å›¾ï¼Œå†…å­˜å±‚é¢ä¸ `Kernel.ByteListView` ç­‰åŒã€‚

* `Kernel.CharacterStreamView` ï¼šå­—ç¬¦æµè§†å›¾ï¼Œå†…å­˜å±‚é¢ä¸ `Kernel.ByteStreamView` ç­‰åŒã€‚

ä»¥ä¸‹æ˜¯é€šè¿‡ä¸Šè¿°æ¥å£è¿›è¡Œå†…å­˜è¯»å†™çš„ä¾‹å­ï¼š

```ts
// ç”³è¯· 16 å­—èŠ‚å†…å­˜ç©ºé—´
let data = Kernel.ByteArray.allocate(Kernel.Size.value(16n));
// è·å– data å¯¹åº”çš„å†…å­˜ç©ºé—´çš„è§†å›¾ï¼Œæ­¤æ—¶ view ä¸ data æŒ‡å‘åŒä¸€å—å†…å­˜
let view = data.view();
// è·å– view å¯¹åº”å†…å­˜ç©ºé—´çš„å°ºå¯¸ï¼Œæ­¤æ—¶ä¸º 16n å³ 16 å­—èŠ‚
let size = view.size().value;
// è·å– data å¯¹åº”çš„ JS å€¼ï¼Œè¿™ä¼šå¾—åˆ°ä¸€ä¸ª ArrayBuffer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯å¯¹ data å¯¹åº”å†…å­˜çš„æ·±å¤åˆ¶ï¼Œè€Œä¸æŒ‡å‘ data å¯¹åº”çš„å†…å­˜ç©ºé—´ã€‚
let data_buffer = data.value;
// è·å– view å¯¹åº”çš„ JS å€¼ï¼Œè¿™ä¼šå¾—åˆ°ä¸€ä¸ª ArrayBuffer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸å¤åˆ¶ view æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œå®ƒä¸ view åŠ data æŒ‡å‘äº†åŒä¸€å†…å­˜ç©ºé—´ã€‚
let view_buffer = view.value;
// è·å– view ä¸­ [4, 12] åŒºé—´çš„å†…å­˜ç©ºé—´è§†å›¾ã€‚
let view_sub = view.sub(Kernel.Size.value(4n), Kernel.Size.value(8n));
// ä»¥ view_sub ä¸ºè§†å›¾æºæ„é€ æµè§†å›¾
let stream = Kernel.ByteStreamView.watch(view_sub);
// å°†æµå®šä½è®¾ä¸º 2n ï¼Œæ­¤æ—¶æµä½äº view_sub å†…å­˜ç©ºé—´ä¸­çš„ç¬¬ 3 å­—èŠ‚ï¼Œä¹Ÿæ˜¯ view å†…å­˜ç©ºé—´ä¸­çš„ç¬¬ 11 å­—èŠ‚ã€‚
stream.set_position(Kernel.Size.value(2n));
// è·å–æµå®šä½ï¼Œæ­¤æ—¶ä¸º 2n
stream.position();
```

```ts
// Kernel.CharacterListView æ— æ³•ä» Kernel.ByteArray å¾—åˆ°ï¼Œéœ€è¦ä» Kernel.ByteListView è½¬æ¢ï¼Œchar_view å°†ä¸ view æŒ‡å‘åŒä¸€å†…å­˜ç©ºé—´
let char_view = Kernel.Miscellaneous.cast_ByteListView_to_CharacterListView(view);
// Kernel.String å¯¹è±¡å­˜å‚¨ UTF-8 å­—ç¬¦ä¸²ã€‚
let string = Kernel.String.value('UTF-8 ğŸ˜„ æ±‰å­—');
// è¿˜å¯ä»¥ä» Kernel.String å¯¹è±¡è·å– Kernel.CharacterListView ï¼Œchar_view_of_string å°†æŒ‡å‘ string å­—ç¬¦ä¸²æ•°æ®çš„å†…å­˜ç©ºé—´
let char_view_of_string = Kernel.Miscellaneous.cast_String_to_CharacterListView(string);
// å¦‚æœé‡è®¾ string çš„å†…å®¹ï¼Œå°†å¯¼è‡´å­—ç¬¦ä¸²æ•°æ®å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œæ­¤æ—¶ï¼Œchar_view_of_string æŒ‡å‘çš„å†…å­˜ç©ºé—´ä¸åº”å†è¢«è®¿é—®
string.value = 'xxx';
// å¯ä»¥å°† Kernel.String çš„å†…å­˜è½¬äº¤ç»™ Kernel.ByteArray å¯¹è±¡ï¼ŒKernel.String çš„å†…å®¹å°†å˜ä¸ºç©ºï¼ŒKernel.ByteArray å°†æŒæœ‰åŸæœ¬å½’å± Kernel.String çš„å†…å­˜ç©ºé—´ã€‚
let data = Kernel.Miscellaneous.cast_moveable_String_to_ByteArray(string);
// åŒæ ·å¯ä»¥å°† Kernel.ByteArray çš„å†…å­˜è½¬äº¤ç»™ Kernel.String ï¼Œä½†åº”ç¡®ä¿ Kernel.ByteArray æ‰€æŒæœ‰çš„å†…å­˜å­˜å‚¨çš„æ˜¯ UTF-8 å­—ç¬¦ä¸²æ•°æ®
let string_in_memory = Kernel.Miscellaneous.cast_moveable_ByteArray_to_String(string);
```

### æ–‡ä»¶ç³»ç»Ÿ

å†…æ ¸æ¥å£æä¾›äº†å¯¹æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„è®¿é—®åŠŸèƒ½ã€‚

```ts
// è¯»å– file.txt ä¸­çš„æ–‡æœ¬ä¸º JS å­—ç¬¦ä¸²ï¼Œéœ€ç¡®ä¿ file.txt ä¸­å­˜å‚¨çš„æ˜¯ UTF-8 æ–‡æœ¬
// è®¾å®šæ–‡ä»¶è·¯å¾„
let path = Kernel.Path.value('file.txt');
// è¯»å–æ–‡ä»¶æ•°æ®
let data = Kernel.Storage.read_file(path);
// é€šè¿‡ç§»åŠ¨å†…å­˜çš„æ–¹å¼å°† Kernel.ByteArray è½¬æ¢ä¸º Kernel.String
let string = Kernel.Miscellaneous.cast_moveable_ByteArray_to_String(data);
// å¾—åˆ° Kernel.String å¯¹åº”çš„ JS å­—ç¬¦ä¸²
let string_value = string.value;
```

```ts
// éå†æŸä¸€ç›®å½•ä¸‹çš„å­æ–‡ä»¶
// è®¾å®šéœ€è¦éå†çš„ç›®å½•è·¯å¾„
let target = Kernel.Path.value('C:/dir1');
// è®¾å®šéå†æ·±åº¦ï¼Œå¦‚æœä¸ºnullï¼Œåˆ™éå†æ‰€æœ‰å±‚çº§
let depth = Kernel.SizeOptional.value(2n);
// è·å–ç›®å½•ä¸­çš„æ‰€æœ‰å­æ–‡ä»¶è·¯å¾„
let path_list = Kernel.Storage.list_file(target, depth);
for (let e of path_list.value) {
	// éå†å­æ–‡ä»¶è·¯å¾„
}
```

### JSON è¯»å†™

å†…æ ¸æ¥å£æä¾›äº†å¯¹ JSON çš„æ”¯æŒï¼Œä½†ä¸æ ‡å‡† JSON ä¸åŒï¼Œå¯ä»¥å‚è§ [å¸¸è§é—®é¢˜](./question.md#JSON-æ–‡ä»¶æ ¼å¼) ä¸­çš„è¯´æ˜ã€‚

```ts
// è°ƒç”¨ KernelX ä¸­å°è£…çš„ JSON å­—ç¬¦ä¸²è§£æåŠŸèƒ½å°† JS å­—ç¬¦ä¸²è½¬æ¢ä¸º Kernel.JSON.Value å¯¹è±¡
let j1 = KernelX.JSON.read_s<{
	int: bigint;
	num: number;
}>(`{ 'int': 0, 'num': 1.2 }`);
let j2 = Kernel.JSON.Value.value({
	int: 0,
	num: 1.2,
});
j1.value.int === j2.value.int; // false ï¼Œå› ä¸º j1 ä¸­çš„ int å±æ€§å€¼ç±»å‹ä¸º bigint ï¼Œè€Œ j2 ä¸º number
```

### ç‰¹æ®Šæ–‡ä»¶ç¼–ç è§£ç 

å†…æ ¸æ¥å£æä¾›äº†å¯¹å¤šç§ç‰¹æ®Šæ–‡ä»¶çš„ç¼–ç ã€è§£ç æ”¯æŒï¼Œä¾‹å¦‚ PTXã€PAM ã€BNK ã€RSB ã€‚

å†…æ ¸æ¥å£ä¸€èˆ¬æ˜¯åŸºäºå†…å­˜çš„ï¼Œå¦‚æœéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œè§£ç ï¼Œéœ€è¦å…ˆè¯»å–æ–‡ä»¶å†…å®¹åˆ°å†…å­˜ï¼Œå†è°ƒç”¨å¤„ç†å‡½æ•°è¿›è¡Œè§£ç ï¼Œä¸‹é¢ä»¥è§£ç BNKæ–‡ä»¶ä¸ºä¾‹ï¼š

```ts
// å¯¹ Kernel.Tool.Wwise.SoundBank.Decode æ¥å£çš„å°è£…
export function decode_fs(
	data_file: string, // BNKæ–‡ä»¶è·¯å¾„
	definition_file: string, // è¾“å‡ºçš„å®šä¹‰æ–‡ä»¶è·¯å¾„ï¼Œå³BNKä¸­çš„æ•°æ®ä¿¡æ¯
	embedded_media_directory: string, // è¾“å‡ºçš„BNKå†…åµŒWEMè·¯å¾„
	version: typeof Kernel.Tool.Wwise.SoundBank.Version.Value, // BNKæ–‡ä»¶ç‰ˆæœ¬
): void {
	// æ–‡ä»¶ç‰ˆæœ¬
	let version_c = Kernel.Tool.Wwise.SoundBank.Version.value(version);
	// ä»å¤–å­˜è¯»å–æ•°æ®åˆ°å†…å­˜
	let data = Storage.read_file(data_file);
	// æ„é€ æµè§†å›¾å¯¹è±¡ï¼Œä½œä¸ºè§£ç å‡½æ•°çš„è¾“å…¥
	let stream = Kernel.ByteStreamView.watch(data.view());
	// æ„é€ å®šä¹‰å¯¹è±¡ï¼Œä½œä¸ºè§£ç å‡½æ•°çš„è¾“å‡º
	let definition = Kernel.Tool.Wwise.SoundBank.Definition.SoundBank.default();
	// è°ƒç”¨è§£ç å‡½æ•°ï¼Œå®Œæˆä¹‹åï¼Œstream.position() å°†å­˜å‚¨å·²è¯»å–çš„æ•°æ®æ€»æ•°ï¼Œè¿™å¯ä»¥ç”¨äºåˆ¤åˆ«BNKæ–‡ä»¶çš„å®é™…å°ºå¯¸
	Kernel.Tool.Wwise.SoundBank.Decode.process_sound_bank(stream, definition, Kernel.PathOptional.value(embedded_media_directory), version_c);
	// å°†è§£ç å¾—åˆ°çš„å®šä¹‰æ•°æ®å­˜å‚¨ä¿å­˜ä¸ºæ–‡ä»¶
	KernelX.JSON.write_fs(definition_file, definition.get_json(version_c));
	return;
}
// è§£ç BNKæ–‡ä»¶
decode_fs(
	'C:/sample.bnk',
	'C:/sample.bnk.bundle/definition.json',
	'C:/sample.bnk.bundle/embedded_media',
	{ number: 140n },
);
```

### å†…æ ¸æ¥å£å°è£…

å†…æ ¸æ¥å£çš„è°ƒç”¨è¾ƒä¸ºç¹çï¼Œ`Script` ä¸­å·²ç»å¯¹å†…æ ¸æ¥å£è¿›è¡Œäº†å°è£…ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿åœ°ä½¿ç”¨å†…æ ¸æ¥å£ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š

* `utility/kernel_x` ï¼šå¯¹å¤§éƒ¨åˆ†å†…æ ¸æ¥å£è¿›è¡Œå°è£…ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ã€JSONä¸XMLçš„å­—ç¬¦ä¸²æˆ–æ–‡ä»¶å¼çš„åºåˆ—åŒ–åŠŸèƒ½ã€ç‰¹æ®Šæ–‡ä»¶çš„æ–‡ä»¶å¼ç¼–ç è§£ç åŠŸèƒ½ã€ç­‰ã€‚

* `utility/thread_manager` ï¼šå¯¹çº¿ç¨‹åŠŸèƒ½è¿›è¡Œå°è£…ã€‚

* `utility/process_helper` ï¼šå¯¹è¿›ç¨‹åŠŸèƒ½è¿›è¡Œå°è£…ï¼Œå¯ä»¥é€šè¿‡å®ƒæ‰§è¡Œå…¶ä»–å¯æ‰§è¡Œç¨‹åºã€‚

* `utility/shell` ï¼šå¯¹å¤–å£³å›è°ƒä¸å¤–å£³ä¸“æœ‰åŠŸèƒ½çš„å°è£…ã€‚

* `utility/console` ï¼šå¯¹æ§åˆ¶å°äº¤äº’çš„å°è£…ï¼ŒåŸºäºä¸åŒçš„ `Shell` å®¢æˆ·ç«¯å®ç°æä¾›ä¸€è‡´çš„ç”¨æˆ·äº¤äº’ã€‚

* `...`
